(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{378:function(t,s,a){"use strict";a.r(s);var n=a(40),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"模板编译"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#模板编译"}},[t._v("#")]),t._v(" 模板编译")]),t._v(" "),a("p",[t._v("从v2.0.0 版本开始，jntemplate 正式支持模板编译功能，在默认配置下，引擎将在第一次执行模板时自动对模板进行编译。")]),t._v(" "),a("p",[t._v("同时也支持用户手动对模板进行预编译：")]),t._v(" "),a("h2",{attrs:{id:"编译模板文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#编译模板文件"}},[t._v("#")]),t._v(" 编译模板文件")]),t._v(" "),a("p",[t._v("对指定的模板文件进行编译, 方法: "),a("code",[t._v("Engine.CompileFile(...)")])]),t._v(" "),a("h3",{attrs:{id:"参数说明"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参数说明"}},[t._v("#")]),t._v(" 参数说明")]),t._v(" "),a("p",[a("strong",[t._v("name")]),t._v("：")]),t._v(" "),a("p",[t._v("模板名称,必须是唯一不重复的字符,如果为"),a("code",[t._v("null")]),t._v(",默认会使用模板文件的绝对路径做为模板的name。")]),t._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[t._v("WARNING")]),t._v(" "),a("ol",[a("li",[a("code",[t._v("name")]),t._v(" 会为做模析缓存键使用,如果重复会导致异常。")]),t._v(" "),a("li",[t._v("如果指定了自定义的"),a("code",[t._v("name")]),t._v(",在使用对应的"),a("code",[t._v("Engine.LoadTemplate(...)")]),t._v("方法加载模板时，必须指定同样的"),a("code",[t._v("name")]),t._v("。")])])]),t._v(" "),a("p",[a("strong",[t._v("fileName")]),t._v("：")]),t._v(" "),a("p",[t._v("模板路径，可以使用相对路径或者绝对路径。如：")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("/var/wwwroot/index.html")]),t._v(" unix 系统绝对路径")]),t._v(" "),a("li",[a("code",[t._v("c:\\wwwroot\\index.html")]),t._v(" windows 系统绝对路径")]),t._v(" "),a("li",[a("code",[t._v("template/index.html")]),t._v(" 相对路径。注意相对路径不要在前面加其它符号，比如"),a("code",[t._v("/")])])]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),a("p",[t._v("如果使用的是相对路径，引擎会去"),a("code",[t._v("ResourceDirectories")]),t._v("里面按顺序寻找模板文件，如果未配置该参数，或者文件不存在，则会引发资源未发现的异常。")])]),t._v(" "),a("p",[a("strong",[t._v("action")]),t._v("：")]),t._v(" "),a("p",[t._v("编译变量配置Action，通过action可以为模板中用到的变量指定类型。该类型必须与实际参数类型一致。")]),t._v(" "),a("h3",{attrs:{id:"示例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#示例"}},[t._v("#")]),t._v(" 示例")]),t._v(" "),a("p",[t._v("以下代码演示如何编译一个模板文件"),a("code",[t._v("demo.html")]),t._v(":")]),t._v(" "),a("div",{staticClass:"language-csharp extra-class"},[a("pre",{pre:!0,attrs:{class:"language-csharp"}},[a("code",[t._v("    Engine"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("CompileFile")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"demo"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('@"c:\\wwwroot\\index.html"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ctx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        ctx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Set")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"name"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token type-expression class-name"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("string")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        ctx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Set")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"id"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token type-expression class-name"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//..其它参数 此处只需要指定类型即可，不需要传实际的值")]),t._v("\n        ctx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CurrentPath "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(' @"c'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v('\\wwwroot\\"'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//当前模板文件目录")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("此处指定了模板名称"),a("code",[t._v("demo")]),t._v(",在使用"),a("code",[t._v("LoadTemplate")]),t._v("时，也必须指定该名称："),a("code",[t._v("Engine.LoadTemplate('demo',@\"c:\\wwwroot\\index.html\")")])]),t._v(" "),a("h2",{attrs:{id:"编译模板内容"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#编译模板内容"}},[t._v("#")]),t._v(" 编译模板内容")]),t._v(" "),a("p",[t._v("如果模板不是来源于文件，而是来源于字符串，可以使用"),a("code",[t._v("Engine.Compile(...)")]),t._v("进行字符串编译。")]),t._v(" "),a("h3",{attrs:{id:"参数说明-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参数说明-2"}},[t._v("#")]),t._v(" 参数说明")]),t._v(" "),a("p",[a("strong",[t._v("name")]),t._v("：")]),t._v(" "),a("p",[t._v("模板名称,必须是唯一不重复的字符,如果为"),a("code",[t._v("null")]),t._v(",默认会使用模板内容的HashCode做为名称。")]),t._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[t._v("WARNING")]),t._v(" "),a("ol",[a("li",[a("code",[t._v("name")]),t._v(" 会为做模析缓存键使用,如果重复会导致异常。")]),t._v(" "),a("li",[t._v("如果指定了自定义的"),a("code",[t._v("name")]),t._v(",在使用对应的"),a("code",[t._v("Engine.CreateTemplate(...)")]),t._v("方法加载模板时，必须指定同样的"),a("code",[t._v("name")]),t._v("。")])])]),t._v(" "),a("p",[a("strong",[t._v("content")]),t._v("：")]),t._v(" "),a("p",[t._v("模板内容，不能为空或者"),a("code",[t._v("null")]),t._v(".")]),t._v(" "),a("p",[a("strong",[t._v("action")]),t._v("：")]),t._v(" "),a("p",[t._v("编译变量配置Action，通过action可以为模板中用到的变量指定类型。该类型必须与实际参数类型一致。")]),t._v(" "),a("h3",{attrs:{id:"示例-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#示例-2"}},[t._v("#")]),t._v(" 示例")]),t._v(" "),a("p",[t._v("以下代码演示如何编译一个模板内容字符串:")]),t._v(" "),a("div",{staticClass:"language-csharp extra-class"},[a("pre",{pre:!0,attrs:{class:"language-csharp"}},[a("code",[t._v("    Engine"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Compile")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hello"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('@"hello, $name"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ctx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        ctx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Set")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"name"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token type-expression class-name"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("string")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//..其它参数 此处只需要指定类型即可，不需要传实际的值")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("此处指定了模板名称"),a("code",[t._v("hello")]),t._v(",在使用"),a("code",[t._v("CreateTemplate")]),t._v("时，也必须指定该名称："),a("code",[t._v("Engine.CreateTemplate('hello',@\"hello, $name\")")])]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),a("p",[t._v("执行编译成功后，在使用"),a("code",[t._v("Engine.CreateTemplate")]),t._v("时，模板内容可以传空.")])]),t._v(" "),a("h2",{attrs:{id:"模板变更处理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#模板变更处理"}},[t._v("#")]),t._v(" 模板变更处理")]),t._v(" "),a("p",[t._v("引擎基于性能考虑，不会追踪模板内容的变更。如果在模板编译完成后，模板内容发生了变动，可以重新调用对应的编译方法（考见上面的"),a("code",[t._v("编译模板内容")]),t._v("或"),a("code",[t._v("编译模板文件")]),t._v("项）重新编译模板,使变更内容生效，也可以直接使用"),a("code",[t._v("IEngine.Clean()")]),t._v(" 或 "),a("code",[t._v("Engine.Current.Clean()")]),t._v("清空编译对象。")]),t._v(" "),a("h2",{attrs:{id:"其它事项"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#其它事项"}},[t._v("#")]),t._v(" 其它事项")]),t._v(" "),a("p",[t._v("如果你的模板不是来源于文件（比如来源于数据库），可以通过自定义资源加载器("),a("code",[t._v("IResourceLoader")]),t._v(")并在配置方法中指定该类型来支持。")])])}),[],!1,null,null,null);s.default=e.exports}}]);